<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.kh.plklj.delivery.mapper.DeliveryMapper">

	<!-- 배송 리스트 조회-->
	<select id="selectDeliveryList" parameterType="_int" resultType="Manage">
	SELECT DELIVERY.DELIVERY_NO, DELIVERY.PIECE_NO, DELIVERY.MEMBER_NO, PIECE_TITLE, DELIVERY_STATUS, PIECE_STATUS, PIECE_TYPE, DELIVERY_ADDRESS,
			TO_CHAR(DELIVERY_DATE, 'YYYY"년" MM"월" DD"일"') AS "DELIVERY_DATE", 
			TO_CHAR(DELIVERY_ING_DATE, 'YYYY"년" MM"월" DD"일"') AS "DELIVERY_ING_DATE",
			TO_CHAR(DELIVERY_END_DATE, 'YYYY"년" MM"월" DD"일"') AS "DELIVERY_END_DATE",
			TO_CHAR(SELL_PRICE, 'FM999,999,999,999') AS "SELL_PRICE", 
			TO_CHAR(END_PRICE, 'FM999,999,999,999') AS "END_PRICE"
	FROM DELIVERY
	JOIN PIECE ON PIECE.PIECE_NO = DELIVERY.PIECE_NO
	JOIN AUCTION ON AUCTION.PIECE_NO = DELIVERY.PIECE_NO
	LEFT JOIN PIECE_SELL ON PIECE_SELL.PIECE_NO = DELIVERY.PIECE_NO
	WHERE DELIVERY.MEMBER_NO = #{memberNo}
	ORDER BY DELIVERY_DATE DESC
	</select>
	
	<!-- 배송 리스트 최신순 정렬 -->
	<select id="selectDeliveryListOrderByDateDesc" resultType="Manage">
		SELECT * 
		FROM DELIVERY
		ORDER BY DELIVERY_DATE DESC
	</select>
	
	<!-- 배송 리스트 오래된순 정렬 -->
	<select id="selectDeliveryListOrderByDateAsc" resultType="Manage">
		SELECT * 
		FROM DELIVERY
		ORDER BY DELIVERY_DATE ASC
	</select>
	
	<!-- 일별 날짜 목록 조회 -->
	<select id="findByDate" parameterType="string" resultType="Manage">
	    SELECT *
	    FROM DELIVERY
	    WHERE DELIVERY_DATE = TO_DATE(#{date}, 'YYYY-MM-DD')
	    ORDER BY DELIVERY_DATE DESC
	</select>
	
	<!-- 월별 날짜 목록 조회 -->
	<select id="findByMonth" parameterType="string" resultType="Manage">
	    SELECT *
	    FROM DELIVERY
	    WHERE TO_CHAR(DELIVERY_DATE, 'YYYY-MM') = #{month}
	    ORDER BY DELIVERY_DATE DESC
	</select>
	
	<!-- 주별 날짜 목록 조회 -->
	<select id="findByWeek" parameterType="string" resultType="Manage">
	    SELECT *
	    FROM DELIVERY
	    WHERE TO_CHAR(DELIVERY_DATE, 'IYYY-IW') = #{week}
	    ORDER BY DELIVERY_DATE DESC
	</select>
	
	<!-- 전체 조회 -->
	<select id="findAll" resultType="Manage">
	    SELECT *
	    FROM DELIVERY
	    ORDER BY DELIVERY_DATE DESC
	</select>


	

</mapper>